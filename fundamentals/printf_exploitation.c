// #include <stdio.h>
// #include <string.h>

// int main(void) {
//     char input[200];

//     printf("Enter some text: ");
//     if (fgets(input, sizeof(input), stdin) == NULL) {
//         return 1;
//     }
//     /* remove newline if present */
//     input[strcspn(input, "\n")] = '\0';

//     /* DANGEROUS: using untrusted input as the format string */
//     printf(input);              /* <-- vulnerable pattern (don't do this) */
//     printf("\n");

//     return 0;
// }

// gcc printf_exploitation.c -o printf_exploitation -Wall -Wformat -Wno-format-extra-args -Wformat-security -Wformat-nonliteral
// clang printf_exploitation.c -o printf_exploitation -Wall -Wformat -Wno-format-extra-args

////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include <stdio.h>
#include <string.h>

int main(void) {
    char input[200];

    printf("Enter some text: ");
    if (fgets(input, sizeof(input), stdin) == NULL) {
        return 1;
    }
    input[strcspn(input, "\n")] = '\0';

    /* SAFE: use a fixed format string and pass input as an argument */
    printf("%s\n", input);

    return 0;
}
